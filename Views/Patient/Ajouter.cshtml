   @model PatientViewModel

@{
    ViewData["Title"] = "Ajouter un patient";
}


<form asp-action="Ajouter" asp-controller="Patient" method="post" enctype="multipart/form-data">

    <div class="form-group">
        <label asp-for="Nom"></label>
        <input asp-for="Nom" class="form-control" />
        <span asp-validation-for="Nom" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="Prenom"></label>
        <input asp-for="Prenom" class="form-control" />
        <span asp-validation-for="Prenom" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="NuméroSécuritéSociale"></label>
        <input asp-for="NuméroSécuritéSociale" class="form-control" />
        <span asp-validation-for="NuméroSécuritéSociale" class="text-danger"></span>
    </div>

    <div>
        <label asp-for="Sexe"></label>
        <select asp-for="Sexe" class="form-control">
            <option value="">Sélectionnez le sexe</option>
            @foreach (var sexe in Enum.GetValues(typeof(Sexe)))
            {
                <option value="@sexe">@sexe</option>
            }
        </select>
        <span asp-validation-for="Sexe" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="Taille"></label>
        <input asp-for="Taille" class="form-control" />
        <span asp-validation-for="Taille" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="Poids"></label>
        <input asp-for="Poids" class="form-control" />
        <span asp-validation-for="Poids" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="DateNaissance"></label>
        <input asp-for="DateNaissance" class="form-control" type="date" max="@DateTime.Now.ToString("yyyy-MM-dd")" min="1900-01-01" />
        <span asp-validation-for="DateNaissance" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="Adresse"></label>
        <input asp-for="Adresse" class="form-control" />
        <span asp-validation-for="Adresse" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="Ville"></label>
        <input asp-for="Ville" class="form-control" />
        <span asp-validation-for="Ville" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label for="Photo">Photo</label>
        <input type="file" name="Photo" class="form-control" accept=".jpg,.jpeg,.png" />
        <span asp-validation-for="Photo" class="text-danger"></span>
    </div>

<p>Antécents</p>
<div class="form-group row">
    <div class="col-sm-10">
        <select id="ComboBoxMultiselectAntecedents" name="AntecedentIdSelectionnes" multiple class="tom-select">
            @foreach (var antecedent in Model.Antecedents)
            {
                <option value="@antecedent.AntecedentId">@antecedent.Nom</option>
            }
        </select>
    </div>
</div>

    <p>Allergies</p>
    <div class="form-group row">
        <div class="col-sm-10">
            <select id="ComboBoxMultiselectAllergies" name="AllergieIdSelectionnes" multiple class="tom-select">
                @foreach (var allergie in Model.Allergies)
                {
                    <option value="@allergie.AllergieId">@allergie.Nom</option>
                }
            </select>
        </div>
    </div>

    <button type="submit" class="btn btn-primary">Enregistrer</button>
</form>
<div>
    <a asp-action="Index">Retour à la liste</a>
</div>

@section Scripts {
    <script>
        // Initialisation de TomSelect pour les deux sélecteurs
        new TomSelect('#ComboBoxMultiselectAntecedents', {
            plugins: ['remove_button'],      // Pour permettre la suppression d'éléments sélectionnés
            maxOptions: null,                // Affiche toutes les options sans limitation
            create: false,                   // Désactive la création de nouvelles options par l'utilisateur
            maxItems: null,                  // Permet plusieurs sélections (multi-sélection)
            sortField: { field: "text", direction: "asc" },  // Tri alphabétique
            placeholder: "Sélectionner un ou plusieurs antécédents...",
        });

        new TomSelect('#ComboBoxMultiselectAllergies', {
            plugins: ['remove_button'],
            maxOptions: null,
            create: false,
            maxItems: null,
            sortField: { field: "text", direction: "asc" },
            placeholder: "Sélectionner une ou plusieurs allergies...",
        });
    </script>
}


