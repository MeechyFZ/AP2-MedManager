@model Patient
@{
    ViewData["Title"] = "Détail du Patient";
}

<div class="container mt-4">
    <!-- Carte des informations générales -->
    <div class="card shadow-sm mb-4">
        <div class="card-header text-center">
            <h4>Informations Générales</h4>
        </div>
        <div class="card-body">
            <p><strong>Nom :</strong> @Model.Nom</p>
            <p><strong>Prénom :</strong> @Model.Prenom</p>
            <p><strong>Âge :</strong> @(Model.Age) ans</p>
            <p><strong>Sexe :</strong> @Model.Sexe</p>
            <p><strong>Numéro de Sécurité Sociale :</strong> @Model.NumeroSecuriteSocial</p>
            <p><strong>Adresse :</strong> @Model.Adresse, @Model.Ville</p>
        </div>
    </div>

    <!-- Navigation des sections médicales -->
    <div class="text-center mb-3">
        <div class="btn-group" role="group" aria-label="Navigation historique médical">
            <button type="button" class="btn btn-outline-primary" onclick="showSection('ordonnances')">Ordonnances</button>
            <button type="button" class="btn btn-outline-primary" onclick="showSection('allergies')">Allergies</button>
            <button type="button" class="btn btn-outline-primary" onclick="showSection('antecedents')">Antécédents</button>
        </div>
    </div>

    <!-- Sections médicales -->
    <div id="ordonnances" class="medical-section">
        <h4 class="mb-3 text-center">Ordonnances</h4>
        @if (Model.Ordonnances.Any())
        {
            <div class="row">
                @foreach (var ordonnance in Model.Ordonnances)
                {
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title">Ordonnance du @ordonnance.DateDebut.ToShortDateString()</h5>
                                <p><strong>Médicaments :</strong> @string.Join(", ", ordonnance.Medicaments.Select(m => m.Nom))</p>
                                <p><strong>Info supplémentaire :</strong> @ordonnance.InfoSupplementaire</p>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="text-center">Aucune ordonnance trouvée pour ce patient.</p>
        }
    </div>

    <div id="allergies" class="medical-section" style="display: none;">
        <h4 class="mb-3 text-center">Allergies</h4>
        @if (Model.Allergies.Any())
        {
            <div class="row">
                @foreach (var allergie in Model.Allergies)
                {
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title">Allergie : @allergie.Nom</h5>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="text-center">Aucune allergie trouvée pour ce patient.</p>
        }
    </div>

    <div id="antecedents" class="medical-section" style="display: none;">
        <h4 class="mb-3 text-center">Antécédents</h4>
        @if (Model.Antecedents.Any())
        {
            <div class="row">
                @foreach (var antecedent in Model.Antecedents)
                {
                    <div class="col-md-4 mb-4">
                        <div class="card shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title">Antécédent : @antecedent.Nom</h5>
                            </div>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="text-center">Aucun antécédent trouvé pour ce patient.</p>
        }
    </div>

    <!-- Bouton retour -->
    <div class="mt-4">
        <a asp-action="Index" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Retour à la liste
        </a>
    </div>
</div>

@section Scripts {
    <script>
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.medical-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById(sectionId).style.display = 'block';
        }
    </script>
}

